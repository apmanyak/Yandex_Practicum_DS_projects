# Определение наиболее выгодного региона нефтедобычи


## Описание проекта

Предоставлены пробы нефти в трёх регионах. Характеристики для каждой скважины в регионе уже известны. Построим модель для определения региона, где добыча принесёт наибольшую прибыль.

Цель: определить, где добывающей компании бурить новую скважину.

Шаги для выбора локации:

- В избранном регионе ищут месторождения, для каждого определяют значения признаков;
- Строят модель и оценивают объём запасов;
- Выбирают месторождения с самым высокими оценками значений. Количество месторождений зависит от бюджета компании и стоимости разработки одной скважины;
- Прибыль равна суммарной прибыли отобранных месторождений.


Условия задачи:
- Для обучения модели подходит только линейная регрессия (остальные — недостаточно предсказуемые).
- При разведке региона исследуют 500 точек, из которых с помощью машинного обучения выбирают 200 лучших для разработки.
- Бюджет на разработку скважин в регионе — 10 млрд рублей.
- При нынешних ценах один баррель сырья приносит 450 рублей дохода. Доход с каждой единицы продукта составляет 450 тыс. рублей, поскольку объём указан в тысячах баррелей.
- После оценки рисков нужно оставить лишь те регионы, в которых вероятность убытков меньше 2.5%. Среди них выбирают регион с наибольшей средней прибылью.

Данные синтетические: детали контрактов и характеристики месторождений не разглашаются.


## Навыки и инструменты

- **python**
- **pandas**
- **matplotlib**
- **numpy**
- **seaborn**

- **scikit-learn**
  - from sklearn.model_selection import train_test_split 
  - from sklearn.linear_model import LinearRegression 
  - from sklearn.metrics import mean_squared_error
  - from sklearn.preprocessing import StandardScaler

## Вывод

**Шаг 1. Загрузка и подготовка данных**

Было представлено 3 датафрема по трем регионам. В каждом датафрейме изначально было 100 000 строк и 5 столбоцов. 

По итогу исследования каждого датафрема:
- удалили столбоец id и в итоговый датафреймах стало 4 столбца. 
- выделили столбцы отвечающие за признаки и столбец за целевой признак
- пустые данные отсутсвовали
- дупликатов нет
- столбцы соответсвуют своим типам данным
- в столбце id во всех датафреймах наблюдалось незначительное кол-во повторяющихся значений. Так как данные искусственны было сделано предположение, что возникла ошбка при их формаировании.
- в данных не наблюдается явный перевес в какую-либо сторону (дисбаланса). все значения в столбцах распределены по нормальному закону распределния или равномерно. вероятно сказывается их искусственность. Однако значения между столбцами имеют разные порядки, предлагается в дальнейшем выбполнить масштабирование данных перед обучением модели. 
- Также искусственность значений  отображется в их корреляции. Что по большей части они мало связаны.


**Шаг 2. Обучение и проверка модели**

Были выполнены шаги:
1. разбиенеи данных на тренировочную и валидационную выборку. в соотношение 75% на 25%
2. обучение данных на моделе линейной регрессии
3. полученные результаты:

- регион 1

Cредний запас предсказанного сырья: 92.59256778438035 тыс. бареллей\
MSE модели линейной регрессии на валидационной выборке: 1412.2129364399243 тыс. бареллей\
RMSE модели линейной регрессии на валидационной выборке: 37.5794217150813 тыс. бареллей\

- регион 2

Cредний запас предсказанного сырья: 68.728546895446 тыс. бареллей\
MSE модели линейной регрессии на валидационной выборке: 0.7976263360391157 тыс. бареллей\
RMSE модели линейной регрессии на валидационной выборке: 0.893099286775617 тыс. бареллей\

- регион 3

Cредний запас предсказанного сырья: 94.96504596800489 тыс. бареллей\
MSE модели линейной регрессии на валидационной выборке: 1602.3775813236196 тыс. бареллей\
RMSE модели линейной регрессии на валидационной выборке: 40.02970873393434 тыс. бареллей\

В регионе 1 и 3 высоки средний запаз предсказанного сырья, однако RMSE составляет практически 38-40

В регионе 2 RMSE = 0.893099286775617. Значение маленькое, значит модель предсказывает значения более точно.


**Шаг 3. Подготовка к расчёту прибыли**

- были выделены ключевые параметры и зафиксированны в переменных
- Проведен расчет достаточного объёма сырья для безубыточной разработки новой скважины: 111.11111111111111 тыс. барелей
- Написана функция для расчета прибыли по выбранным скважинам и предсказаниям модели


**Шаг 4. Расчёт прибыли и рисков**
Была применена техника Bootstrap.

Вычислены для каждого региона следующие данные:

1. Регион 1

- Средний доход: 396.16498480237146 млн рублей
- 2.5%-квантиль: -111.21554589049533 млн рублей
- 97.5%-квантиль: 909.7669415534222 млн рублей
- Доля убытков: 6.9 %

2. Регион 2

- Средний доход: 456.04510578666105 млн рублей
- 2.5%-квантиль: 33.82050939898541 млн рублей
- 97.5%-квантиль: 852.2894538660361 млн рублей
- Доля убытков: 1.5 %

3. Регион 3

- Средний доход: 404.4038665683571 млн рублей
- 2.5%-квантиль: -163.35041339560078 млн рублей
- 97.5%-квантиль: 950.3595749238001 млн рублей
- Доля убытков: 7.6 %

Предлагается задействовать Регион 2, так как у него самая низкая доля убытков и высокий средний доход. доверительный интервал лежит в положительной области значений