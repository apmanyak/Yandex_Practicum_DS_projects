# Исследование технологического процесса очистки золота


## Описание проекта

Строится модель машинного обучения для промышленной компании, разрабатывающая решения для эффективной работы промышленных предприятий. Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды на основе данных с параметрами добычи и очистки. Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками. 


## Навыки и инструменты

- **python**
- **pandas**
- **scipy**
- **numpy**
- **seaborn**

- **scikit-learn**
    - from sklearn.dummy import DummyRegressor
    - from sklearn.ensemble import RandomForestRegressor
    - from sklearn.tree import DecisionTreeRegressor
    - from sklearn.linear_model import LinearRegression 
    - from sklearn.preprocessing import StandardScaler
    - from sklearn.model_selection import cross_val_score
    - from sklearn.metrics import (mean_absolute_error,
                             make_scorer)

## Вывод

Подготовлен прототип модели машинного обучения. Предложено решение для эффективной работы промышленных предприятий.

Модель предсказывает коэффициент восстановления золота из золотосодержащей руды. 

Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

Этапы выполнения проекта:

**1. Шаг 1 Подготовка данных**

На данном этапе были загружены датафреймы:

- gold_recovery_train_new.csv — обучающая выборка;
- gold_recovery_test_new.csv — тестовая выборка;
- gold_recovery_full_new.csv — исходные данные.


По выведеным данным можно сказать следующее:

1. data_train
- Строк: 14149. Столбцов: 86
- Кол-во столбцов с пропусками: 62. 
- Уникальные дупликаты отсутсвуют
- более 11% от всего датаферйма пропущенных значений в одном из столбце.

2. data_test
- Строк: 5290. Столбцов: 52
- Кол-во столбцов с пропусками: 12. 
- Уникальные дупликаты отсутсвуют

3. data_full
- Строк: 19439. Столбцов: 86
- Кол-во столбцов с пропусками: 63. 
- Уникальные дупликаты отсутсвуют
- более 8% от всего датаферйма пропущенных значений в одном из столбце.

Кол-во столбцов в data_test и data_train не совпадало. Былл проведен анализ признаков и скорректировано кол-во столбцов в данных.

Все  значения в столбцах соответсвуют своему типу данных

Построение общей гистограммы для всех числовых столбцов таблицы не проводилось, так как столбцов очень много и рано оценивать распределние данных и поиске выбросов и дисбаланса. Была попытка вывести матрицу корреляции между столбцами, но график получился не особо информативными


Проверно, что эффективность обогащения (флотации) рассчитана правильно на обучающей выборке для признака rougher.output.recovery
Также вычислена средняя абсолютная ошибка (MAE) между нашими расчётами и значением признака. MAE = 9.73512347450521e-15.

Также были утсранены пропуски за счет применения метода интерполяции (с помощью метода interpolate) в основному датафрейму и последующего заполнения полученными данными оставшихся данных(методом fillna)


**2. Шаг2 Анализ данных**

- Изменение концентрации металлов (Au, Ag, Pb) на различных этапах очистки

Наблюдается, что концетрация золота с каждым последующим этапом равномерно растет.

У серебра концетрация немного выросла на этапе флотации, но затем пошло на спад.

У свинца концетрация росла до первой очистки и дальше перестало расти.


- Сравнение распределения размеров гранул сырья на обучающей и тестовой выборках

Проведено сравнение распределения размеров гранул сырья на обучающей и тестовой выборках столбцов:

1) rougher.input.feed_size 

Построив график было замечено, что распределение у графиков отличается. У тренировочной выборки преобладают значения около 55, а у обучающей большое кол-во объектов сконцетрировано до 55.

2) primary_cleaner.input.feed_size.

Можем видеть, что распределения отличаются незначительно. Немного отличается частота встречи данных значений выборке.

Из-за первого распределения не желательно дальше работать с такими данными.

- Исследование суммарной концентрации всех веществ на разных стадиях: в сырье, в черновом и финальном концентратах

На графике гистограммы суммарной концентрации всех веществ на стадии в черновом концтрате наблюдается всплеск значений около нуля. При том, что на этапе сырь и последующей финальной концетрации такого всплеска не наблюдается.
Нули составляют 2% от всех значений. 
В рамках данной работы предлагается оставить.


**3. Шаг3 Построеие модели**

Была написана функция для вычисления итоговой sMAPE.

Воссозданы в тестовой выборке целевые признаки.

Выделены целевые признаки и признаки у тетсовой и тренировочной выборки.

Проведено моедлировани для этапов rougher и final.

Были рассмотрены модели: Решающее дерево, Случайный лес, Линейная ререссия.

Расчитаны метрики на обучающей выборке:
- Итоговое sMAPE на обучающей выборке для Линейной регрессии  9.908491628373296
- Итоговое sMAPE на обучающей выборке для модели Решающее дерево 8.897320011132253
- Итоговое sMAPE на обучающей выборке для модели Случайный лес 8.584771869068927

Лучшей оказалась модель: Случайный лес

На этапе флотации(rougher) Случаный лес с гиперпараметрами:

- Лучшая max_depth: 3
- Лучшая n_estimators: 25

На этапе final  Случаный лес с гиперпараметрами:

- Лучшая max_depth: 3
- Лучшая n_estimators: 15


Расчитаны метрики на тестовой выборке:
- sMAPE_rougher на тестовой выборке 4.896602772886467
- sMAPE_final на тестовой выборке 7.923626262216615
- Итоговое sMAPE на тестовой выборке 7.166870389884078
- Итоговое sMAPE на тестовой выборке для константной модели 7.766604067388526

Значение на тестовой выборке получилось меньше среднего константной модели. Следовательно модель обучается корректно


