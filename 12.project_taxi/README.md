# Прогнозирование количества заказов такси на следующий час


## Описание проекта

Компания такси собрала исторические данные о заказах такси в аэропортах. Чтобы привлекать больше водителей в период пиковой нагрузки, нужно спрогнозировать количество заказов такси на следующий час. Необходимо построить модель для такого предсказания.


## Навыки и инструменты

- **python**
- **pandas**
- **matplotlib**
- **numpy**
- **seaborn**
- **scikit-learn**
  - from sklearn.model_selection import (
    GridSearchCV, 
    RandomizedSearchCV,
    train_test_split,
    cross_val_score,
    TimeSeriesSplit,
    cross_validate
)
  - from sklearn.compose import make_column_transformer
  - from sklearn.pipeline import make_pipeline
  - from sklearn.preprocessing import StandardScaler
  - from sklearn.linear_model import (
    LinearRegression, 
    Ridge
    )
  - from sklearn.metrics import (
    mean_squared_error,
    make_scorer
)
- **lightgbm**
- **catboost**
- from statsmodels.tsa.seasonal import seasonal_decompose

## Вывод

Значение метрики *RMSE* на тестовой выборке должно быть не больше 48.

По заданию необходимо построить модель для предсказания количества заказов такси на следующий час, чтобы привлекать больше водителей в период пиковой нагрузки, на основании исторических данных о заказах такси в аэропортах, которые предоставила компания.

Значение метрики *RMSE* на тестовой выборке должно быть не больше 48.

Для выполнения данного проекта были выполнены следущие шаги:

- ШАГ 1

В даннном пункте был загружен датасет и проведена превая оценка исходных данных. При чтение файла столбец с датами мы преобразовали в индексы нашего датасета.

- Строк: 26496. Столбцов: 1
- Кол-во столбцов с пропусками: 0. 
- Уникальные дупликатов 26415. Однако их удалять не будем. 
- Cтолбцы соответсвуют своего типу данных
- Данные расположены в хронологическом порядке
- аномалий в значениях не наблюдаются
- Данные преставлены с 1 марта 2018 по 31 августа 2018. Данные представлены за 6 месяцев. Данные предоставлены с шагом в 10 минут

- ШАГ 2

В даннном пункте были проанализированы предоставленные данные во времени.

- было замеченно, среднее значение спроса к услугам такси растет со временем.Ряд не станционарный.
- наблюдается сезонность дня.
- даты не влияют на спрос. влияет день недели. было замечено, что очень большой спрос каждый понедельник.
- по выходным срос маленький
- временные периода спроса ориентировочно: 9-10ч, 16-17ч и 1-2ч ночи


- ШАГ 3

В данном пункте были рассмотрены 4 модели машинного обучения:
1. Ridge
2. LinearRegression
3. LightGBM
4. CatBoost

Данные были предварительно разделены на тренировочную и тестовую выборку в соотношение 90:10.
Проведено масштабирование данных.
Созданы признаки

Лучшие результаты по RMSE у модели LightGBM, однако у Ridge неплохие показатели времени на обучение и предсказание.
Думаю клиенту в данному случае разнича в  ms критичной не будет, а вот показатель в RMSE будет выйгрышней. Поэтому выберем модель LightGBM


- ШАГ 4

На тестовой выборке результаты :
- RMSE 44.31814
- время обучения:5.68 s 
- время предсказания: 26.9 ms





